import re
import os

class TextModifier:
    def __init__(self, folder_path):
        self.folder_path = folder_path
        self.rules = []

    def add_rule(self, pattern, replacement):
        self.rules.append((pattern, replacement))

    def apply_rules(self, text):
        for pattern, replacement in self.rules:
            text = re.sub(pattern, replacement, text)
        return text

    def modify_files_in_folder(self):
        for file_name in os.listdir(self.folder_path):
            if file_name.endswith('.txt'):  # تأكد من أن الملف نصي
                file_path = os.path.join(self.folder_path, file_name)
                self.modify_text(file_path)

    def modify_text(self, file_path):
        with open(file_path, 'r', encoding='utf-8') as file:
            text = file.read()
        modified_text = self.apply_rules(text)
        with open(file_path, 'w', encoding='utf-8') as file:
            file.write(modified_text)

folder_path = r"ألفاظ مولدة آليا"
modifier = TextModifier(folder_path)
# باب فَعَلَ يَفْعِلُ
modifier.add_rule(r'ِيُ،', 'ِي،')  #إبدال حركة كسر بعدها ياء عليها ضمة مثل (يَقْضِيُ إلى يَقْضِي)
modifier.add_rule(r'َيُ،', 'َى،')  #إبدال حركة فتحة بعدها ياء عليها ضمة  إلى فتحة بعدها ألفاء مقصورة، مثل (يَسْعَيُ،) إلى (يَسْعَى،).
modifier.add_rule(r'َيَ:', 'َى:')  #حذف حركة وإبدال حرف بحرف؛ حالة حركة فتح بعدها ياء عليها فتحة مثل (قَضَيَ إلى قَضَى)
modifier.add_rule(r'ِيْ،', 'ِ،') #حذف حرف وحركة؛ حالة جزم المعتلّ؛ كسرة بعدها ياء ساكنة، فتحذف مثل (اقْضِيْ إلى اقْضِ)
modifier.add_rule(r'ِيُوا،', 'ُوا،') #قلب حركة وحذف حرف؛ حالة كسرة بعدها ياء عليها ضمة، مثل: (اقْضِيُوا) إلى (اقْضُوا)
modifier.add_rule(r'َي:', 'َى:') # تعديل كسرة بعدها ياء متطرفة ساكنة إلى ألف مقصورة مثل (قَضَي إلى قَضَى)
modifier.add_rule(r'ِيِي،', 'ِي،') #حذف الياء الأولى مع كسرتها، في حالة ياء مكسورة بعدها ياء ساكنة في آخر الكلمة مثل: (اقْضِيِي،) إلى (اقْضِي،)
modifier.add_rule(r'ِيْنَ،', 'ِينَ،')#حذف حركة الياء الساكنة المسبوقة بكسرة مثل: (اقْضِيْنَ،) إلى (اقْضِينَ،)
modifier.add_rule(r'ِيُونَ،', 'ُونَ،') # حذف الياء المضمومة التي بعدها واو ونقل حركتها إلى الحرف الذي قبلها (تَقْضِيُونَ،) إلى (تَقْضُونَ،).
modifier.add_rule(r'ِيِينَ،', 'ِينَ،') # حذف الياء المكسورة التي قبلها كسرة وبعدها ياء ساكنة مثل (تَقْضِيِين،) إلى (تَقْضِينَ،).
modifier.add_rule(r'َيُوا،', 'َوْا،') # حذف الياء المضمومة المفتوح ما قبلها، ووضع فتحة على الواو مجانسة لما قبلها مثل: (قَضَيُوا،) إلى (قَضَوْا،).
modifier.add_rule(r'ِيْنَ', 'ِينَ') # حذف حركة الياء الساكنة المكسورة ما قبلها، وبعدها نون، مثل: (يَقْضِيْنَ) إلى (يَقْضِينَ).
#باب فَعَلَ يَفْعَلُ
modifier.add_rule(r'َي،', 'َى،')  # إبدال الياء الساكنة المسبوقة بفتح بألف مقصورة، مثل: (يَسْعَي،) إلى (يَسْعَى،).
modifier.add_rule(r'َيْ،', 'َ،') # حذف الياء الساكنة في آخر الكلمة المفتوح ما قبلها، مثل: (اسْعَيْ،) إلى (اسْعَ،).
modifier.add_rule(r'َيِي،', 'َيْ،') #حذف الياء الأولى مع كسرتها، المسبوقة بفتحة، ونقل هذه الفتحة للياء الثانية المتطرفة، مثل: (اسْعَيِي،) إلى (اسْعَيْ،)
modifier.add_rule(r'َيُونَ،', 'َوْنَ،') #حذف الياء المضمومة المسبوقة بفتحة، وووضع سكون على الواو بعدها، مثل: (تَسْعَيُونَ،) إلى (تَسْعَوْنَ،)
modifier.add_rule(r'َيِينَ،', 'ِينَ،') #حذف الياء الأولى المسكورة المفتوح ما قبلها، وقلب الفتحة قبلها إلى كسرة، مثل: (تَسْعَيِينَ،) إلى (تَسْعِينَ،).

#أَفْعَلَ يُفْعِلُ
modifier.add_rule(r'َيَ،', 'َى،')  #حذف حركة وإبدال حرف بحرف؛ حالة حركة فتح بعدها ياء عليها فتحة مثل (أَلْقَيَ إلى أَلْقَى)

#فَعَّلَ يُفَعِّلُ
#modifier.add_rule(r'ِّي،', 'ِّ،')  #حذف حرف العلّة من فعل الأمر مثل (صَلِّي إلى صَلِّ) || لم أفعّل الكود لأنه سيحذف ياء المضارع مثل (يُصلِّي إلى يُصَلِّ) 
# أحتاج إلى كود منفصل فعل ذلك

#الأسماء
modifier.add_rule(r'ُي:', 'ِي:')  #لتصويب ما كان على وزن (تَفَاعُل) من المعتل الياء الناقص مثل (تَقَاضُي إلى تَقَاضِي)
modifier.add_rule(r'ِيي:', 'ِيّ:') #تعديل كسرة ياء ساكنة ثم ياء ساكنة إلى كسرة مع ياء مشددة متطرفة مثل (قَضِيي إلى قَضِيّ)

modifier.modify_files_in_folder()
